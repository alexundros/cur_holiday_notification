# Календарь торгов по валютам

Данный проект создан из «спортивного» интереса. Первоначально было достаточно простое техническое задание и одна реализация на python. Но я решил попробовать переписать это же решение на нескольких других языках. По моей задумке реализация должна быть очень близка с исходному варианту. Хотя я имею опыт во многих языках которые планирую использовать в проекте, все дополнительные реализации начинаются при помощи ИИ которому дается задание переписать python реализация на другой язык. И после этого начинаются мои работа что бы заставить этот код работать. Вот тут и есть та самая «спортивная» часть =)

На первом этапе есть 3 реализации:

- python
- go
- rust

Была попытка сделать zig реализацию, но она не взлетела и остается в планах. Экосистема Zig пока слишком молодая что бы легко её использовать для переноса как go или rust.

Полученная скорость работы каждой реализации на разных тестовый файлах:

**P** - Python, **G** - Go, **R** - Rust. Круг запуска тестов #**N**. Время в ms.

| XML                   | P#1   | G#1   | R#1   | P#2   | G#2   | R#2   | P#3   | G#3   | R#3   |
|-----------------------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| 0230301-20230331.xml  | 2.749 | 1.497 | 1.337 | 2.742 | 1.502 | 1.216 | 2.545 | 0.999 | 1.288 |
| 20231201-20231231.xml | 2.746 | 1.500 | 1.141 | 2.629 | 1.000 | 1.041 | 2.790 | 1.499 | 1.135 |
| 20240201-20240229.xml | 3.272 | 1.500 | 1.165 | 2.878 | 1.998 | 1.138 | 3.107 | 1.502 | 1.130 |

## TODO

- Добавление Linux сборки
- Добавление сборки Docker образов
- Добавление сборки в github actions
- Добавление реализации на C
- Добавление реализации на Zig
- Добавление 100% покрытия тестами


## Техническое задание

1\) Утилита должна быть автономна и запускаться без каких-либо дополнительных настроек.

2\) В состав утилиты входит настроечный файл, содержащий в себе информацию о связке валютного инструмента и валюты. Предлагается использовать обычный текстовый файл (кодировка Win-1251), где в каждой строке содержится пара по валюте: «валютная инструмент» = «валюта». Если строка начинается с символа «;», то данная строка считается комментарием и не подлежит обработке.

```ini
; Файл настроек утилиты «Календарь валют» от 25.05.2025
[features]
; Выборка общих праздников
HDay = true
[items]
; Информация представлена строкой «валютная инструмент» = «валюта»
CNYRUB_TOD = CNY
USDRUB_TOD = USD
HKDRUB_TOD = HKD
```

Утилита не проверяет целостность данных и не контролирует верность заполнения настроечного файла. В случае невозможности прочитать файл или распарсить информацию, утилита завершает работу с ошибкой «Не могу прочитать файл настроек».

3\) На вход утилите подается файл «Cur-holiday-notification-YYYYMMDD-YYYYMMDD.xml», содержащий информацию о неторговых днях по соответствующей валютному инструменту на ММВБ за период YYYYMMDD-YYYYMMDD, указанный в наименовании файла. 

Файлы с примерами приложены в «test_xmlfiles».

4\) Утилита, выбирает неторговые дни из входного файла по валютному инструменту, имеющегося в файле настроек утилиты и выводит информацию в файл результата в виде строки: «Валюта» = «Дата». 

Дата заполняется из тэга = «ReportDate», наименование валютного инструмента ищется в тэге = «SecShortName».

Например:

4.1\) В настроечном файле есть строка «KGSRUB_TOD = KGS».

4.2\) Во входном файле есть конструкция:

```xml
<CUX50 ReportDate="2023-03-21">
<GROUP TradeGroup="N" DescribeGroup="">
    <SECURITY SecurityId="KGSRUBTODTOM" SecShortName="KGS\_TODTOM" ReWritable="Y"/>
    <SECURITY SecurityId="KGSRUB\_TOD" SecShortName="KGSRUB\_TOD" ReWritable="Y"/>
    <SECURITY SecurityId="KZTRUBTDSTMS" SecShortName="KZT\_TDSTMS" ReWritable="Y"/>
    </GROUP>
</CUX50>
```

4.3\) То в выходной файл выводим строку: KGS = 2023-03-21. Выполняем для всех строк настроечного файла и входного файла.

Пример файла результата:

```
; Файл результата утилиты «Календарь валют»
CNY = 2024-02-12
CNY = 2024-02-13
CNY = 2024-02-14
USD = 2024-02-19
```

В случае невозможности создать или записать информацию в выходной файл, утилита завершает работу с ошибкой «Не могу создать/записать файл результата».


5\) Утилита, выбирает праздничные дни из входного файла, которые в файле как «H» (Holliday) и выводит в выходной файл в виде строки: “HDay = 2025-05-09”. В файле таких дат может быть несколько, или не быть.

```xml
<CUX50 ReportDate="2025-05-09">
    <GROUP TradeGroup="H" DescribeGroup="">
        <SECURITY SecurityId="CALMAIN" SecShortName="" ReWritable="Y"/>
    </GROUP>
</CUX50>
```
