# Календарь торгов по валютам

Данный проект создан из «спортивного» интереса. Первоначально было достаточно простое техническое задание и одна реализация на python. Но я решил попробовать переписать это же решение на нескольких других языках. По моей задумке реализация должна быть очень близка с исходному варианту. Хотя я имею опыт во многих языках которые планирую использовать в проекте, все дополнительные реализации начинаются при помощи ИИ которому дается задание переписать python реализация на другой язык. И после этого начинаются мои работа что бы заставить этот код работать. Вот тут и есть та самая «спортивная» часть =)

На первом этапе есть 3 реализации:

- python
- go
- rust

Была попытка сделать zig реализацию, но она не взлетела и остается в планах. Экосистема Zig пока слишком молодая что бы легко её использовать для переноса как go или rust.

Полученная скорость работы каждой реализации на разных тестовый файлах:

Круг запуска тестов #n. Время отражено в секундах.

|              | 0230301-20230331.xml | 20231201-20231231.xml |20240201-20240229.xml |
|--------------|----------------------|-----------------------|----------------------|
| #1 Py script | 0.001983             | 0.002065              | 0.002470             |
| #1 Py app    | 0.002747             | 0.003029              | 0.002867             |
| #1 Go app    | 0.001000             | 0.003004              | 0.001500             |
| #1 Rust app  | 0.001291             | 0.001035              | 0.001166             |
| #2 Py script | 0.001902             | 0.002086              | 0.002486             |
| #2 Py app    | 0.002700             | 0.002710              | 0.003318             |
| #2 Go app    | 0.001001             | 0.002999              | 0.001501             |
| #2 Rust app  | 0.001190             | 0.001008              | 0.001327             |
| #3 Py script | 0.001944             | 0.002133              | 0.002413             |
| #3 Py app    | 0.002580             | 0.002613              | 0.003531             |
| #3 Go app    | 0.001503             | 0.003001              | 0.001499             |
| #3 Rust app  | 0.001225             | 0.000983              | 0.001239             |

## TODO

- Добавление Linux сборки
- Добавление сборки Docker образов
- Добавление сборки в github actions
- Добавление реализации на C
- Добавление реализации на Zig
- Добавление 100% покрытия тестами
- Возможно: (но это не так интересно)
  - Добавление реализации на Java/Kotlin
  - Добавление реализации на C#


## Техническое задание

1\) Утилита должна быть автономна и запускаться без каких-либо дополнительных настроек.

2\) В состав утилиты входит настроечный файл, содержащий в себе информацию о связке валютного инструмента и валюты. Предлагается использовать обычный текстовый файл (кодировка Win-1251), где в каждой строке содержится пара по валюте: «валютная инструмент» = «валюта». Если строка начинается с символа «;», то данная строка считается комментарием и не подлежит обработке.

```ini
; Файл настроек утилиты «Календарь валют» от 25.05.2025
[features]
; Выборка общих праздников
HDay = true
[items]
; Информация представлена строкой «валютная инструмент» = «валюта»
CNYRUB_TOD = CNY
USDRUB_TOD = USD
HKDRUB_TOD = HKD
```

Утилита не проверяет целостность данных и не контролирует верность заполнения настроечного файла. В случае невозможности прочитать файл или распарсить информацию, утилита завершает работу с ошибкой «Не могу прочитать файл настроек».

3\) На вход утилите подается файл «Cur-holiday-notification-YYYYMMDD-YYYYMMDD.xml», содержащий информацию о неторговых днях по соответствующей валютному инструменту на ММВБ за период YYYYMMDD-YYYYMMDD, указанный в наименовании файла. 

Файлы с примерами приложены в «test_xmlfiles».

4\) Утилита, выбирает неторговые дни из входного файла по валютному инструменту, имеющегося в файле настроек утилиты и выводит информацию в файл результата в виде строки: «Валюта» = «Дата». 

Дата заполняется из тэга = «ReportDate», наименование валютного инструмента ищется в тэге = «SecShortName».

Например:

4.1\) В настроечном файле есть строка «KGSRUB_TOD = KGS».

4.2\) Во входном файле есть конструкция:

```xml
<CUX50 ReportDate="2023-03-21">
<GROUP TradeGroup="N" DescribeGroup="">
    <SECURITY SecurityId="KGSRUBTODTOM" SecShortName="KGS\_TODTOM" ReWritable="Y"/>
    <SECURITY SecurityId="KGSRUB\_TOD" SecShortName="KGSRUB\_TOD" ReWritable="Y"/>
    <SECURITY SecurityId="KZTRUBTDSTMS" SecShortName="KZT\_TDSTMS" ReWritable="Y"/>
    </GROUP>
</CUX50>
```

4.3\) То в выходной файл выводим строку: KGS = 2023-03-21. Выполняем для всех строк настроечного файла и входного файла.

Пример файла результата:

```
; Файл результата утилиты «Календарь валют»
CNY = 2024-02-12
CNY = 2024-02-13
CNY = 2024-02-14
USD = 2024-02-19
```

В случае невозможности создать или записать информацию в выходной файл, утилита завершает работу с ошибкой «Не могу создать/записать файл результата».


5\) Утилита, выбирает праздничные дни из входного файла, которые в файле как «H» (Holliday) и выводит в выходной файл в виде строки: “HDay = 2025-05-09”. В файле таких дат может быть несколько, или не быть.

```xml
<CUX50 ReportDate="2025-05-09">
    <GROUP TradeGroup="H" DescribeGroup="">
        <SECURITY SecurityId="CALMAIN" SecShortName="" ReWritable="Y"/>
    </GROUP>
</CUX50>
```
